"use strict";(self.webpackChunkarrow_website=self.webpackChunkarrow_website||[]).push([["9004"],{29894:function(e,i,r){r.r(i),r.d(i,{metadata:()=>n,default:()=>h,frontMatter:()=>s,contentTitle:()=>a,toc:()=>d,assets:()=>l});var n=JSON.parse('{"id":"learn/quickstart/setup/serialization","title":".. with serialization","description":"How to (de)serialize Arrow Core types.","source":"@site/content/docs/learn/quickstart/setup/serialization.md","sourceDirName":"learn/quickstart/setup","slug":"/learn/quickstart/setup/serialization","permalink":"/learn/quickstart/setup/serialization","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"serialization","title":".. with serialization","description":"How to (de)serialize Arrow Core types.","sidebar_position":1},"sidebar":"learnSidebar","previous":{"title":"Setup","permalink":"/learn/quickstart/setup/"},"next":{"title":"From other FP languages","permalink":"/learn/quickstart/from-fp"}}'),t=r(74848),o=r(28453);let s={id:"serialization",title:".. with serialization",description:"How to (de)serialize Arrow Core types.",sidebar_position:1},a="Serialization",l={},d=[{value:"kotlinx.serialization",id:"kotlinxserialization",level:2},{value:"Jackson",id:"jackson",level:2}];function c(e){let i={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"serialization",children:"Serialization"})}),"\n",(0,t.jsxs)(i.p,{children:["Arrow Core types, such as ",(0,t.jsx)(i.code,{children:"Either"})," or ",(0,t.jsx)(i.code,{children:"NonEmptyList"}),", often appear as part\nof serializable types. We've decided to keep the Core library as slim as\npossible; in particular we didn't want to depend on particular serialization\nlibraries. As a result, you need a bit of additional ceremony compared to\nusing built-in types, which we discuss in this section."]}),"\n",(0,t.jsx)(i.h2,{id:"kotlinxserialization",children:(0,t.jsx)(i.a,{href:"https://github.com/Kotlin/kotlinx.serialization",children:"kotlinx.serialization"})}),"\n",(0,t.jsxs)(i.p,{children:["If you're using kotlinx.serialization, you need to depend on the\n",(0,t.jsx)(i.code,{children:"arrow-core-serialization"})," with the same version of your ",(0,t.jsx)(i.code,{children:"arrow-core"}),".\nDeclare your serializable types as usual. However, when one of the fields\nmentions a type from Arrow Core,"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"@Serializable\ndata class Book(val title: String, val authors: NonEmptyList<String>)\n"})}),"\n",(0,t.jsxs)(i.p,{children:['you need to "import" the serializer into the file. The easiest way is to\ninclude a ',(0,t.jsx)(i.code,{children:"UseSerializers"})," annotation at the very top."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"@file:UseSerializers(\n  EitherSerializer::class,\n  IorSerializer::class,\n  OptionSerializer::class,\n  NonEmptyListSerializer::class,\n  NonEmptySetSerializer::class\n)\n"})}),"\n",(0,t.jsx)(i.p,{children:"The list above mentions all the serializers, but you only need to add those\nwhich are used in your fields. Don't worry too much: if you miss one, the\nkotlinx.serialization plug-in gives you an error."}),"\n",(0,t.jsxs)(i.p,{children:["Additionally, you can use ",(0,t.jsx)(i.code,{children:"arrow.core.serialization.ArrowModule"})," to register run-time ",(0,t.jsx)(i.a,{href:"https://github.com/Kotlin/kotlinx.serialization/blob/master/docs/serializers.md#contextual-serialization",children:"contextual serialization"})," support of the Arrow Core types."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"val format = Json { serializersModule = ArrowModule }\n"})}),"\n",(0,t.jsx)(i.p,{children:"or by merging with another serializers module"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"val format = Json { serializersModule = myModule + ArrowModule }\n"})}),"\n",(0,t.jsx)(i.p,{children:"This will allow for use of the Arrow Core types as the value to be serialized without specifying the serializer explicitly:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'val payload = format.encodeToString(nonEmptyListOf("hello", "world"))\n'})}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsxs)(i.p,{children:["Using ",(0,t.jsx)(i.code,{children:"@UseSerializers"})," to provide static ",(0,t.jsx)(i.em,{children:"compile-time"})," serialization of fields containing Arrow Core types is usually preferable to annotating fields with ",(0,t.jsx)(i.code,{children:"@Contextual"})," and relying on ",(0,t.jsx)(i.em,{children:"run-time"})," resolution, wherever possible."]})}),"\n",(0,t.jsx)(i.admonition,{title:"Additional reading",type:"info",children:(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.a,{href:"https://garthgilmour.medium.com/marshalling-arrow-types-in-ktor-bc471aa3650",children:(0,t.jsx)(i.em,{children:"Marshalling Arrow Types in Ktor"})}),"\nby Garth Gilmour includes additional information about using Arrow Core types\nin a Ktor project."]})}),"\n",(0,t.jsx)(i.h2,{id:"jackson",children:(0,t.jsx)(i.a,{href:"https://github.com/FasterXML/jackson",children:"Jackson"})}),"\n",(0,t.jsxs)(i.p,{children:["If you're using Jackson for serialization, you need to depend on the\n",(0,t.jsx)(i.code,{children:"arrow-core-jackson"})," with the same version of your ",(0,t.jsx)(i.code,{children:"arrow-core"}),".\nYou just need to call an additional method when\ncreating the mapper."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"val mapper = ObjectMapper()\n    .registerKotlinModule()\n    .registerArrowModule()   // <- this is the one\n"})})]})}function h(e={}){let{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},28453:function(e,i,r){r.d(i,{R:()=>s,x:()=>a});var n=r(96540);let t={},o=n.createContext(t);function s(e){let i=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),n.createElement(o.Provider,{value:i},e.children)}}}]);