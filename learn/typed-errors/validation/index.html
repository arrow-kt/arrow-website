<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-learn/typed-errors/validation" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Validation | Arrow</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:image content=https://arrow-kt.io/img/social-card.jpg /><meta data-rh=true name=twitter:image content=https://arrow-kt.io/img/social-card.jpg /><meta data-rh=true property=og:url content=https://arrow-kt.io/learn/typed-errors/validation/ /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-default-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current /><meta data-rh=true property=og:title content="Validation | Arrow"/><meta data-rh=true name=description content="Worked out example of validation."/><meta data-rh=true property=og:description content="Worked out example of validation."/><link data-rh=true rel=icon href=/img/arrow-brand-icon.svg /><link data-rh=true rel=canonical href=https://arrow-kt.io/learn/typed-errors/validation/ /><link data-rh=true rel=alternate href=https://arrow-kt.io/learn/typed-errors/validation/ hreflang=en /><link data-rh=true rel=alternate href=https://arrow-kt.io/learn/typed-errors/validation/ hreflang=x-default /><link rel=alternate type=application/rss+xml href=/community/blog/rss.xml title="Arrow RSS Feed"><link rel=alternate type=application/atom+xml href=/community/blog/atom.xml title="Arrow Atom Feed"><link rel=stylesheet href=/assets/css/styles.8bb0fd9c.css /><script src=/assets/js/runtime~main.dbc143ef.js defer></script><script src=/assets/js/main.63b3d8dc.js defer></script></head><body class=navigation-with-keyboard><svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/><div class=navbar__logo><img src=/img/arrow-brand.svg alt="Arrow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/img/arrow-brand-dark.svg alt="Arrow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a class="navbar__item navbar__link" href=/>Home</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button href=/learn/overview/>Learn</a><ul class=dropdown__menu><li><a class=dropdown__link href=/learn/quickstart/>Quickstart</a><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/learn/typed-errors/>Typed errors</a><li><a class=dropdown__link href=/learn/coroutines/>Concurrency and resources</a><li><a class=dropdown__link href=/learn/resilience/>Resilience</a><li><a class=dropdown__link href=/learn/immutable-data/>Immutable data</a><li><a class=dropdown__link href=/learn/collections-functions/>Collections and functions</a><li><a class=dropdown__link href=/learn/design/>Design recipes</a><li><a class=dropdown__link href=/learn/projects/>Example projects</a><li><a class=dropdown__link href=/learn/integrations/>Integrations</a></ul></div><a href=https://apidocs.arrow-kt.io target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">API Docs<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link>Community</a><ul class=dropdown__menu><li><a class=dropdown__link href=/community/blog/>Blog</a><li><a class=dropdown__link href=/libraries/>More libraries</a></ul></div><div class=navbar__item><img src="https://img.shields.io/maven-central/v/io.arrow-kt/arrow-core?color=5b88f8&label=latest"></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><div class="navbar__search searchBarContainer_NW3z" dir=ltr><input placeholder=Search aria-label=Search class="navbar__search-input searchInput_YFbd" value="" /><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/learn/quickstart/><span title=Quickstart class=categoryLinkLabel_W154>Quickstart</span></a><button aria-label="Expand sidebar category 'Quickstart'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/learn/typed-errors/><span title="Typed errors" class=categoryLinkLabel_W154>Typed errors</span></a><button aria-label="Collapse sidebar category 'Typed errors'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/learn/typed-errors/working-with-typed-errors/><span title="Working with typed errors" class=linkLabel_WmDU>Working with typed errors</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/learn/typed-errors/validation/><span title=Validation class=linkLabel_WmDU>Validation</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/learn/typed-errors/wrappers/><span title="Wrapper types" class=categoryLinkLabel_W154>Wrapper types</span></a><button aria-label="Expand sidebar category 'Wrapper types'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/learn/typed-errors/from-either-to-raise/><span title="From Either to Raise" class=linkLabel_WmDU>From Either to Raise</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/learn/coroutines/><span title="Concurrency and resources" class=categoryLinkLabel_W154>Concurrency and resources</span></a><button aria-label="Expand sidebar category 'Concurrency and resources'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/learn/resilience/><span title=Resilience class=categoryLinkLabel_W154>Resilience</span></a><button aria-label="Expand sidebar category 'Resilience'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/learn/immutable-data/><span title="Immutable data" class=categoryLinkLabel_W154>Immutable data</span></a><button aria-label="Expand sidebar category 'Immutable data'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/learn/collections-functions/><span title="Collections and functions" class=categoryLinkLabel_W154>Collections and functions</span></a><button aria-label="Expand sidebar category 'Collections and functions'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/learn/design/><span title="Design recipes" class=categoryLinkLabel_W154>Design recipes</span></a><button aria-label="Expand sidebar category 'Design recipes'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/learn/projects/><span title="Example projects" class=linkLabel_WmDU>Example projects</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/learn/integrations/><span title=Integrations class=linkLabel_WmDU>Integrations</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/learn/summary/><span title=Summary class=linkLabel_WmDU>Summary</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-hidden"><a class=menu__link href=/learn/overview/><span title=overview class=linkLabel_WmDU>overview</span></a></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Validation</h1></header>
<p>This tutorial shows a concrete example of using typed errors to implement
domain validation. In particular, we begin with the following domain:</p>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#D4D4D4;--prism-background-color:#222E51><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style=color:#D4D4D4;background-color:#222E51><code class=codeBlockLines_e6Vv><span class=token-line style=color:#D4D4D4><span class="token keyword" style=color:#82a2f3>data</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>class</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>Author</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> name</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token keyword" style=color:#82a2f3>data</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>class</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>Book</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> title</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> authors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> NonEmptyList</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">Author</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br/></span></code></pre></div></div>
<p>over which we want to implement the following rules,
and accumulate as many errors as possible.</p>
<ol>
<li class="">The given title should not be empty,</li>
<li class="">The list of authors should <a class="" href=/learn/collections-functions/non-empty/>not be empty</a>,</li>
<li class="">None of the author names should be empty.</li>
</ol>
<p>We are going to follow the <a href=https://lexi-lambda.github.io/blog/2019/11/05/parse-don-t-validate/ target=_blank rel="noopener noreferrer" class=""><em>parse, don't validate</em></a>
approach to validation. In short, instead of first creating potentially
erronenous instances of our classes, we shall only <em>build</em> such an instance
whenever the components satisfy all the constraints.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=smart-constructors>Smart constructors<a href=#smart-constructors class=hash-link aria-label="Direct link to Smart constructors" title="Direct link to Smart constructors" translate=no>​</a></h2>
<p>The <code>Author</code> class exposes its constructor, so we cannot prevent the user from creating
it with wrong values. One could introduce a <code>require</code> in the constructor, but we prefer
to use the typed error mechanism instead. A common pattern in this case is to
<em>hide</em> the constructor, and provide a <em>smart constructor</em> by adding an <code>invoke</code>
operator inside the companion object.</p>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#D4D4D4;--prism-background-color:#222E51><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style=color:#D4D4D4;background-color:#222E51><code class=codeBlockLines_e6Vv><span class=token-line style=color:#D4D4D4><span class="token keyword" style=color:#82a2f3>object</span><span class="token plain"> EmptyAuthorName</span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token keyword" style=color:#82a2f3>data</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>class</span><span class="token plain"> Author </span><span class="token keyword" style=color:#82a2f3>private</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>constructor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> name</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>companion</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token keyword" style=color:#82a2f3>operator</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>fun</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>invoke</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">name</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Either</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">EmptyAuthorName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Author</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>TODO</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br/></span></code></pre></div></div>
<p>This way the users of this class still use <code>Author("me")</code> to create a new name,
in the same way one would use a constructor, but actually our <code>invoke</code> function
is called. This allows us to refine the type to an <code>Either</code>, which can return
an error. The implementation uses the <code>either</code> computation block, with <code>ensure</code>
describing the constraint #3.</p>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#D4D4D4;--prism-background-color:#222E51><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style=color:#D4D4D4;background-color:#222E51><code class=codeBlockLines_e6Vv><span class=token-line style=color:#D4D4D4><span class="token keyword" style=color:#82a2f3>data</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>class</span><span class="token plain"> Author </span><span class="token keyword" style=color:#82a2f3>private</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>constructor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> name</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>companion</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token keyword" style=color:#82a2f3>operator</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>fun</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>invoke</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">name</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Either</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">EmptyAuthorName</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Author</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> either </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token function" style=color:#EDB368>ensure</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>isNotEmpty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> EmptyAuthorName </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token function" style=color:#EDB368>Author</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=fail-first-vs-accumulation>Fail-first vs. accumulation<a href=#fail-first-vs-accumulation class=hash-link aria-label="Direct link to Fail-first vs. accumulation" title="Direct link to Fail-first vs. accumulation" translate=no>​</a></h2>
<p>We are going to use a similar approach for <code>Book</code>, introducing a smart
constructor. We have several different errors, though, which we define as
a sealed hierarchy. Note that <code>EmptyAuthor</code> is a different type than before,
since we want to store the index of the author.</p>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#D4D4D4;--prism-background-color:#222E51><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style=color:#D4D4D4;background-color:#222E51><code class=codeBlockLines_e6Vv><span class=token-line style=color:#D4D4D4><span class="token keyword" style=color:#82a2f3>sealed</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>interface</span><span class="token plain"> BookValidationError</span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token keyword" style=color:#82a2f3>object</span><span class="token plain"> EmptyTitle</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> BookValidationError</span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token keyword" style=color:#82a2f3>object</span><span class="token plain"> NoAuthors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> BookValidationError</span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token keyword" style=color:#82a2f3>data</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>class</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>EmptyAuthor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> index</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Int</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> BookValidationError</span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token keyword" style=color:#82a2f3>data</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>class</span><span class="token plain"> Book </span><span class="token keyword" style=color:#82a2f3>private</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>constructor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> title</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> authors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> NonEmptyList</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">Author</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>companion</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token keyword" style=color:#82a2f3>operator</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>fun</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>invoke</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      title</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Iterable</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Either</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">BookValidationError</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Book</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>TODO</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br/></span></code></pre></div></div>
<p>Let's forget about validating each author for a moment, and just implement the
emptiness checks for the title and the authors list. Note that in the latter
case we perform both the check and the conversion to <code>NonEmptyList</code> in a single
go using <code>ensureNotNull</code>.</p>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#D4D4D4;--prism-background-color:#222E51><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style=color:#D4D4D4;background-color:#222E51><code class=codeBlockLines_e6Vv><span class=token-line style=color:#D4D4D4><span class="token keyword" style=color:#82a2f3>data</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>class</span><span class="token plain"> Book </span><span class="token keyword" style=color:#82a2f3>private</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>constructor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> title</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> authors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> NonEmptyList</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">Author</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>companion</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token keyword" style=color:#82a2f3>operator</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>fun</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>invoke</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      title</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Iterable</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Either</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">BookValidationError</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Book</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> either </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token function" style=color:#EDB368>ensure</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>isNotEmpty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> EmptyTitle </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token function" style=color:#EDB368>ensureNotNull</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">authors</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>toNonEmptyListOrNull</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> NoAuthors </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token function" style=color:#EDB368>Book</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>TODO</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br/></span></code></pre></div></div>
<p>This code has a problem, though: it only returns <em>one</em> error, even if there were
two problems with the data of the <code>Book</code>. We would rather use an <em>accumulation</em>
approach, so we can give back as much information as possible to the user.
This requires two changes to the code:</p>
<ul>
<li class="">The result type is now a <code>NonEmptyList</code> of problems,</li>
<li class="">We need to wrap the different validations in <code>zipOrAccumulate</code>.</li>
</ul>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#D4D4D4;--prism-background-color:#222E51><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style=color:#D4D4D4;background-color:#222E51><code class=codeBlockLines_e6Vv><span class=token-line style=color:#D4D4D4><span class="token keyword" style=color:#82a2f3>data</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>class</span><span class="token plain"> Book </span><span class="token keyword" style=color:#82a2f3>private</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>constructor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> title</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> authors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> NonEmptyList</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">Author</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>companion</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token keyword" style=color:#82a2f3>operator</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>fun</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>invoke</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      title</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Iterable</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Either</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">NonEmptyList</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">BookValidationError</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Book</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> either </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token function" style=color:#EDB368>zipOrAccumulate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>ensure</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>isNotEmpty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> EmptyTitle </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>ensureNotNull</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">authors</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>toNonEmptyListOrNull</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> NoAuthors </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> _ </span><span class="token operator" style="color:rgb(212, 212, 212)">-></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">          Unit</span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token function" style=color:#EDB368>Book</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>TODO</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br/></span></code></pre></div></div>
<p>The result of each of the arguments of <code>zipOrAccumulate</code> are available in the
trailing lambda. In this case we are not using them: we have the <code>title</code>
already available, and for the list of authors we still need to perform the
conversion from <code>String</code> to <code>Author</code>.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg xmlns=http://www.w3.org/2000/svg width=24 height=24 fill=none viewBox="0 0 24 24"><path fill=currentColor fill-rule=evenodd d="M4.25 9a7.75 7.75 0 1 1 15.5 0v4.823l2.464 4.927H1.787l2.463-4.927zM10 23h4v-2h-4z" clip-rule=evenodd /></svg></span>Arguments to zipOrAccumulate</div><div class=admonitionContent_BuS1><p>All but the last argument to <code>zipOrAccumulate</code> represent the different
validations we want to run aggregating their output. Those arguments are
often <em>blocks</em> wrapped in <code>{</code> curly braces <code>}</code>, which is a bit unusual for
most Kotliners.</div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=validating-a-list>Validating a list<a href=#validating-a-list class=hash-link aria-label="Direct link to Validating a list" title="Direct link to Validating a list" translate=no>​</a></h2>
<p>The next step is turning the given <code>authors</code>, which is a list of <code>String</code>s, into
a list of <code>Author</code>s. We need to run the smart constructor, thus, but at the same
time we should accumulate any potential problems. Since this is related to
author checks, we'll include this as part of the second validation.</p>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#D4D4D4;--prism-background-color:#222E51><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style=color:#D4D4D4;background-color:#222E51><code class=codeBlockLines_e6Vv><span class=token-line style=color:#D4D4D4><span class="token keyword" style=color:#82a2f3>data</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>class</span><span class="token plain"> Book </span><span class="token keyword" style=color:#82a2f3>private</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>constructor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> title</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> authors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> NonEmptyList</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">Author</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token keyword" style=color:#82a2f3>companion</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>object</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token keyword" style=color:#82a2f3>operator</span><span class="token plain"> </span><span class="token keyword" style=color:#82a2f3>fun</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>invoke</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      title</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> String</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authors</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Iterable</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">String</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> Either</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">NonEmptyList</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">BookValidationError</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> Book</span><span class="token operator" style="color:rgb(212, 212, 212)">></span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> either </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token function" style=color:#EDB368>zipOrAccumulate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>ensure</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>isNotEmpty</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> EmptyTitle </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">          </span><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> validatedAuthors </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>mapOrAccumulate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">authors</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>withIndex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> nameAndIx </span><span class="token operator" style="color:rgb(212, 212, 212)">-></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">            </span><span class="token function" style=color:#EDB368>Author</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">nameAndIx</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">              </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>recover</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> _ </span><span class="token operator" style="color:rgb(212, 212, 212)">-></span><span class="token plain"> </span><span class="token function" style=color:#EDB368>raise</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style=color:#EDB368>EmptyAuthor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">nameAndIx</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">              </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>bind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">          </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">          </span><span class="token function" style=color:#EDB368>ensureNotNull</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">validatedAuthors</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>toNonEmptyListOrNull</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> NoAuthors </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> _</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authorsNel </span><span class="token operator" style="color:rgb(212, 212, 212)">-></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">        </span><span class="token function" style=color:#EDB368>Book</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> authorsNel</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">      </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br/></span></code></pre></div></div>
<p>This additional check is quite complex, so let's unravel it step by step:</p>
<ul>
<li class="">We use <code>authors.withIndex()</code> to create an iterable containing the values
in conjunction with the index they live in, this is necessary to create
the right <code>EmptyAuthor</code> error value.</li>
<li class="">With <code>mapOrAccumulate</code> we state that we want to perform some validation over
a collection of elements, accumulating each possible error.</li>
<li class="">The call to <code>Author(it.value)</code> returns an <code>Either</code> with the wrong error type
(<code>EmptyAuthorName</code> instead of <code>EmptyAuthor</code>). To transform this value we
use the <code>recover</code> extension function.</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg xmlns=http://www.w3.org/2000/svg width=24 height=24 fill=none viewBox="0 0 24 24"><path fill=currentColor fill-rule=evenodd d="M4.25 9a7.75 7.75 0 1 1 15.5 0v4.823l2.464 4.927H1.787l2.463-4.927zM10 23h4v-2h-4z" clip-rule=evenodd /></svg></span>Recover vs. Map Left</div><div class=admonitionContent_BuS1><p>Another possibility would be to use <code>mapLeft { EmptyAuthor(it.index) }</code>.
The difference between <code>recover</code> and <code>mapLeft</code> is that the latter only transforms
the error value, whereas in the former you can use any typed error computation.</div></div>
<ul>
<li class="">Finally, we use <code>.bind()</code> to embed the <code>Either</code> into the computation block.
Essentially, every time you are using a value of type <code>Either</code> inside an
<code>either</code> (or any other <code>Raise</code> block), such a call is required.</li>
</ul>
<p>The result of the mapping is a <code>List&lt;Author></code>, that we can now use to create the
final <code>Book</code>. This value is available in the last lambda of <code>zipOrAccumulate</code>,
that we've called <code>validatedAuthors</code> in the code above.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=variants-of-map--accumulation>Variants of map + accumulation<a href=#variants-of-map--accumulation class=hash-link aria-label="Direct link to Variants of map + accumulation" title="Direct link to Variants of map + accumulation" translate=no>​</a></h3>
<p>In the code above there's one section which can be written in several different
ways, namely the mapping over a list while accumulating any errors raised
during the processing of each of the elements.</p>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#D4D4D4;--prism-background-color:#222E51><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style=color:#D4D4D4;background-color:#222E51><code class=codeBlockLines_e6Vv><span class=token-line style=color:#D4D4D4><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> validatedAuthors </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>mapOrAccumulate</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">authors</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>withIndex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> nameAndIx </span><span class="token operator" style="color:rgb(212, 212, 212)">-></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token function" style=color:#EDB368>Author</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">nameAndIx</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>mapLeft</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>EmptyAuthor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">nameAndIx</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>bind</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br/></span></code></pre></div></div>
<p>This first version uses the variant of <code>mapOrAccumulate</code> which lives in
<code>Raise</code> and takes the collection to work on as first argument. This variant
provides <code>Raise</code> inside the block (hence the need to call <code>.bind()</code>), and
<code>raise</code>s automatically if any error is found.</p>
<p>Another way to write the code above is by creating a list of <code>Either</code> using
<code>map</code>, and then using <code>.bindAll()</code> at the very end. This often turns into
simpler code when your validations use wrapper types, as we do here, since
you don't need to call the intermediate <code>.bind()</code>.</p>
<div class="language-kotlin codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#D4D4D4;--prism-background-color:#222E51><div class=codeBlockContent_QJqH><pre tabindex=0 class="prism-code language-kotlin codeBlock_bY9V thin-scrollbar" style=color:#D4D4D4;background-color:#222E51><code class=codeBlockLines_e6Vv><span class=token-line style=color:#D4D4D4><span class="token keyword" style=color:#82a2f3>val</span><span class="token plain"> validatedAuthors </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> authors</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>withIndex</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>map</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> nameAndIx </span><span class="token operator" style="color:rgb(212, 212, 212)">-></span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">  </span><span class="token function" style=color:#EDB368>Author</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">nameAndIx</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>mapLeft</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"> </span><span class="token function" style=color:#EDB368>EmptyAuthor</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">nameAndIx</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain">index</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#D4D4D4><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token function" style=color:#EDB368>bindAll</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br/></span></code></pre></div></div>
<p>Any of these approaches are equivalent, given that the function that validates
each of the elements doesn't perform any side effects.</div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/learn/typed-errors/working-with-typed-errors/><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Working with typed errors</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/learn/typed-errors/wrappers/><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Wrapper types</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#smart-constructors class="table-of-contents__link toc-highlight">Smart constructors</a><li><a href=#fail-first-vs-accumulation class="table-of-contents__link toc-highlight">Fail-first vs. accumulation</a><li><a href=#validating-a-list class="table-of-contents__link toc-highlight">Validating a list</a><ul><li><a href=#variants-of-map--accumulation class="table-of-contents__link toc-highlight">Variants of map + accumulation</a></ul></ul></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid container_y1z5"><div><div class="margin-bottom--sm logo_cbK_"><a href=https://arrow-kt.io rel="noopener noreferrer" class=footerLogoLink_BH7S><img src=/img/arrow-brand.svg alt="Arrow Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE" width=128 height=42 /><img src=/img/arrow-brand-dark.svg alt="Arrow Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU" width=128 height=42 /></a></div><small><div class=footer__copyright>Arrow is developed and maintained by the community</div></small></div><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class=footer__title></div><ul class="footer__items clean-list"><li class=footer__item><a href=https://apidocs.arrow-kt.io target=_blank rel="noopener noreferrer" class=footer__link-item>API Docs<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><li class=footer__item><a class=footer__link-item href=/community/blog/>Blog</a><li class=footer__item><a class=footer__link-item href=/learn/projects/>Example projects</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>Learn</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/learn/quickstart/>Quickstart</a><li class=footer__item><a class=footer__link-item href=/learn/typed-errors/>Typed errors</a><li class=footer__item><a class=footer__link-item href=/learn/coroutines/>Coroutines</a><li class=footer__item><a class=footer__link-item href=/learn/resilience/>Resilience</a></ul></div><div class="theme-layout-footer-column col footer__col"><div class=footer__title>...</div><ul class="footer__items clean-list"><li class=footer__item><a class=footer__link-item href=/learn/immutable-data/>Immutable data</a><li class=footer__item><a class=footer__link-item href=/learn/collections-functions/>Collections and functions</a><li class=footer__item><a class=footer__link-item href=/learn/design/>Design</a><li class=footer__item><a class=footer__link-item href=/learn/integrations/>Integrations</a></ul></div></div><ul class="clean-list container_dM9r"><li><a href=https://twitter.com/arrow_kt target=_blank rel="noopener noreferrer"><img src=/img/icon-social-twitter.svg alt=Twitter title=Twitter height=24px width=24px /></a><li><a href=https://slack-chats.kotlinlang.org/c/arrow target=_blank rel="noopener noreferrer"><img src=/img/icon-social-slack.svg alt=Slack title=Slack height=24px width=24px /></a><li><a href=https://github.com/arrow-kt target=_blank rel="noopener noreferrer"><img src=/img/icon-social-github.svg alt=GitHub title=GitHub height=24px width=24px /></a><li><a href=https://stackoverflow.com/questions/tagged/arrow-kt target=_blank rel="noopener noreferrer"><img src=/img/icon-social-stackoverflow.svg alt="Stack Overflow" title="Stack Overflow" height=24px width=24px /></a></li><div class=starsContainer_WEfU><div>Loading...</div></div></ul></div></footer></div></body>